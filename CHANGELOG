Version 1.9.9 (September 27, 2010)
----------------------------------
+ Added a new set of variables INET_FORWARD_xxx to allow forwarding INET IPv6 and non-NAT'ed IPv4 packets
  to other interfaces.  The format is similar to the IPv4 NAT_FORWARD_xxx without port mapping.
+ Added a new variable OPEN_ICMPV6 to allow independent control of ICMP for IPv4 and IPv6, enabled by default.
! Fixed handling of INET_DMZ_HOST_OPEN_xxx variables
! Fixed handling of INET_DMZ_HOST_DENY_xxx variables
! Fixed handling of INET_DMZ_DENY_TCP
! Fixed variable typo, INET_DMZ_HOST_DENY_TCP was not handled
+ Added IPv6 reserved network support, label logs by IPv4 and IPv6
! Fixed RESERVED_NET_LOG is now independant from DROP_PRIVATE_ADDRESSES
+ Added option to the configure script to enable/disable IPv6 + several tweaks
* Sanity check should always be the first thing we do since we probably can't
  write the log-file in case we're not root
+ Automatically disable IPV6_SUPPORT if IPv6 is not detected in the kernel
+ Add support for mixed IPv4/IPv6 when IPV6_SUPPORT=1

Version 1.9.2m (September 17, 2010)
-----------------------------------
! Interface detection didn't work in some shells (eg. Dash). We always need to quote this type of stuff!
! Fixes/tweaks in the install script
! Properly handle nat/mangle table rules for IPv4/IPv6
* In case IPv6 is detected, require that the ip6tables-binary is available to ensure a proper/secure policy
+ Implemented IPv6 detection variable so we don't have to perform a sysctl_key for each check
! Several (regression) fixes + improvements related to the previous IPv6 changes
* Changed default policy for IPv6 when IPv4 mode is used (and vice versa). It now
  eg. will accept IPv6 traffic from the internal interface(s) by default (Debian bug #596170)

Version 1.9.2l (August 26, 2010)
--------------------------------
* Implement sysctl_key() function and use it for IPv6 detection (thanks Lonnie)
! The recent changes caused setting net.ipv4.icmp_echo_ignore_all to fail (thanks Lonnie)
* BusyBox doesn't understand grep -x, so use ^$ instead + dots should be escaped (thanks Lonnie)
* From now on explicitly set all variables for sysctl wildcard variables (like "net.ipv4.conf.*.rp_filter")
  since newer kernels handle those differently now (Thanks to Klemen Mihevc)
+ The "Blocked Host" feature adds the BLOCK_HOSTS_BIDIRECTIONAL option to specify whether hosts are
  blocked both Inbound and Outbound (default) or Inbound only. (Thanks Philip)
* Don't masquerade IPv6/proto 41 (thanks Klemen Mihevc)
* Use unset IFS only for actual rules
* Re-added local IFS in environment
+ Added option to enable/disable antispoofing for internal/dmz nets
! Don't "unset IFS" immediately after "local IFS" declaration in functions, this breaks older shells
+ Added option to enable/disable IGMP logging
! Modprobe didn't work properly for old modprobe/distros when modules were compiled in-kernel
+ Configure option to allow user to enable full access for the external subnet
+ Implemented EXT_BROADCAST_CHAIN

Version 1.9.2k (March 25, 2010)
-------------------------------
! check_interface() function didn't work for VLAN interfaces
! Several tweaks & fixes in the install script
+ Add old version detection to the install script
+ Added "Kernel Configuration Special Issues" section to README
+ Updated traffic-shaper-plugin, added two more queues, added more DSCP matches,
  updated "traffic-shaper.conf" template and support local server source port matches.
+ Added 224.0.0.0/24 to the list of broadcast destination addresses
+ Updated traffic-accounting-plugin

Version 1.9.2j (February 26, 2010)
----------------------------------
+ Check for dig/nslookup in the main script when RESOLV_IPS=1
! PLUGIN config & binary path check should be in the main script else our
  install script fails on fresh installs or old 1.8 upgrades

Version 1.9.2i (February 23, 2010)
----------------------------------
* Modify the install script to make the firewall start after the network is brought up on boot
+ Add dig() function wrapper that degrades to nslookup if dig is not available
* Refactor check_binary() into seperate check_command() & check_command_error() functions
+ New DynDNS & Traffic Accounting plugins. Main improvement is that they feature
  host caching now
* Have a seperate function to check our config so we don't fail on a bad config when eg. stopping
+ Have the install script detect interfaces and their properties
* Better (wildcard) interface detection in the main script
* Don't autodetect interface addresses etc. in the main script, instead do it during install
! sysctl() always applied the -w argument which it shouldn't
! DNS failed during startup
* We shouldn't just default (too much) to ANYHOST and/or ANYPORT, if not specified. This is too user error-sensitive (including myself)
! Can't have defaults for protocols
* Misc. tweaks & cosmetics

Version 1.9.2h (January 5, 2010)
--------------------------------
! %0d in the date format is not supported by busybox so replace it with %d (thanks Lonnie)
! Init script for newer Debian/Ubuntu version. Start on system startup,
  only stop on system shutdown. Moreover, do not wait for syslog, but start
  whenever there is network (thanks downstream/Michael Hanke)
* Cleaned up/tweaked sysctl & modprobe functions
* Consistently use 'ip' instead of 'ifconfig' to obtain interface attributes.
+ Add iptables_batch() function to greatly decrease the time to add the "Blocked Host" rules.
  iptables_batch() uses iptables-save and iptables-restore to add rules in batch rather than one-by-one.
  This feature may be disabled by setting DISABLE_IPTABLES_BATCH=1
! Fixed typo in module_probe deprecation warning
+ Autodetect netmask & broadcast addresses for INT_IF & EXT_IF
+ Add a default DROP to the HOST_BLOCK_SRC and HOST_BLOCK_DST chains while they are being built,
  this is most important when using the 'force-reload' verb.  During the time the Blocked Hosts are
  being applied, no new traffic will be allowed in any direction.
+ Add a check for the '-' character in the ip_range() function for improved execution speed.
* The "Blocked Host" feature now also matches the destination address for outbound traffic in addition to the
  previous matching of the source address for inbound traffic.
* The "Blocked Host" logging is now implemented as one rule rather than a rule for each blocked host.
* The "Blocked Host" file may now include a semicolon ';' as a comment delimiter, per the Spamhaus DROP list.
* The "Blocked Host" file (re)load now displays an activity count since this can take awhile.

Version 1.9.2g (November 17, 2009)
----------------------------------
- Removed incorrect comment in sip-voip.conf
! Fixed logging of packets in the INPUT chain because of incorrect use of the POST_INPUT_xxx chains
! Fixed dropping of packets in EXT_INPUT_CHAIN + we should jump into the POST_INPUT_CHAIN first before we DROP

Version 1.9.2f (November 10, 2009)
----------------------------------
* Tweaked some kernel settings
! Fixed modprobe errors. Always use $@ as $* might do things you don't expect! (Thanks Lonnie!)
! Don't disable TCP sack when DoS-reducation is enabled since performance degrades from it

Version 1.9.2e (November 9, 2009)
---------------------------------
+ Added some more DOS-prevention kernel settings (thanks Michiel Klaver)
+ IPv6 module updates
+ Implemented support to set INDENT(space) value for functions in environment
+ Added sysctl_multi() & modprobe_multi() functions to allow probing for several modules/variables at once
! Unify date format in the log (Debian bug #550222)
* Only apply DNAT ctstate rule if explictly enabled from the config file
  (using the NAT_LOCAL_REDIRECT variable). The previous implementation was simply
  too much of a hack.
* We should explicitly enable net.netfilter.nf_conntrack_acct for kernel 2.6.27+
  to allow the use of traffic accounting and such (thank Lonnie)
* Don't /dev/null iptables -t nat related stuff. We just need the nat module, and that's all there is to it
! DROP any new traffic while firewall rules are generated so improper states are not created during start/restart
* The default OUTPUT policy no longer sees traffic after setting up the firewall rules in the chains
! Removed an unconditional ACCEPT in the EXT_OUTPUT_CHAIN keeping the POST_OUTPUT_CHAIN from seeing EXT_IF traffic
! Several fixes/changes for the POST_xxxx_CHAINs. This should make the POST stuff more
  consistent among INPUT/FORWARD/OUTPUT
* Misc. tweaks

Version 1.9.2d (August 24, 2009)
--------------------------------
* Renamed module_probe() to modprobe() and added deprecation warning
+ Updated traffic accounting plugin. Fixes another "rule-leak"
+ Updated sip-voip plugin (thanks Philip)
+ Updated traffic-shaper plugin (thanks Philip)

Version 1.9.2c (July 29, 2009)
------------------------------
! On reinit we must flush all chains in the nat & mangle tables else
  they will keep growing (Thanks Lonnie)
+ Updated IPSEC VPN plugin (Thanks Philip)
+ Updated Traffic Accounting plugin
+ Updated DynDNS Open plugin
+ Updated IDS plugin
! Fixed ICMP checks for IPv6
* Less defaulting to all ports/all hosts for several rules. This should mainly
  improve security in case of incorrect rules/configurations

Version 1.9.2b (June 25, 2009)
------------------------------
! Fixed DSL plugin causing errors on restart
* Detected iptables errors are now reported as WARNING rather than ERROR when the script finishes
+ Updated IPSEC-VPN plugin (Thanks Philip)
* Moved .aif_active_plugins to /var/tmp/
+ Detect plugins on stop() that have their priority number changed

Version 1.9.2a (June 9, 2009)
-----------------------------
* Dropped requirement of the ip binary in the main script

Version 1.9.2 (June 4, 2009)
----------------------------
* Bumped installer version to 1.0
! Fixed check_binary failed on dash-based systems (like Ubuntu) (Thanks Lonnie!)
! Fixed some bashisms
! Fixed DMZ_LAN_HOST_OPEN_IP didn't work

